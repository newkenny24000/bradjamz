<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>8-Track Multi-Instrument Studio</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://unpkg.com/tone@14.7.77/build/Tone.js"></script>
</head>
<body>
    <!-- Track Controls Section -->
    <div class="track-controls">
        <div class="track-control-row" data-track="0">
            <div class="track-control-header">
                <span class="track-label">Track 1</span>
                <div class="track-controls-actions">
                    <button class="sound-gen-btn" data-track="0" title="Generate sound from text">GEN</button>
                    <button class="effects-toggle-btn" data-track="0" title="Toggle effects panel">FX</button>
                </div>
            </div>
            <select class="sound-selector" data-track="0" title="Select sound for this track">
                <option value="">No sound loaded</option>
            </select>
            <div class="track-effects-panel" data-track="0">
                <div class="effect-control">
                    <label>Reverb</label>
                    <input type="range" class="track-reverb" data-track="0" min="0" max="100" value="0">
                    <span class="effect-value">30</span>
                </div>
                <div class="effect-control">
                    <label>Delay</label>
                    <input type="range" class="track-delay" data-track="0" min="0" max="100" value="0">
                    <span class="effect-value">0</span>
                </div>
                <div class="effect-control">
                    <label>Volume</label>
                    <input type="range" class="track-volume" data-track="0" min="0" max="100" value="70">
                    <span class="effect-value">70</span>
                </div>
                <div class="effect-control">
                    <label>Decay</label>
                    <input type="range" class="track-decay" data-track="0" min="0" max="100" value="0">
                    <span class="effect-value">10</span>
                </div>
            </div>
        </div>
        <div class="track-control-row" data-track="1">
            <div class="track-control-header">
                <span class="track-label">Track 2</span>
                <div class="track-controls-actions">
                    <button class="sound-gen-btn" data-track="1" title="Generate sound from text">GEN</button>
                    <button class="effects-toggle-btn" data-track="1" title="Toggle effects panel">FX</button>
                </div>
            </div>
            <select class="sound-selector" data-track="1" title="Select sound for this track">
                <option value="">No sound loaded</option>
            </select>
            <div class="track-effects-panel" data-track="1">
                <div class="effect-control">
                    <label>Reverb</label>
                    <input type="range" class="track-reverb" data-track="1" min="0" max="100" value="0">
                    <span class="effect-value">30</span>
                </div>
                <div class="effect-control">
                    <label>Delay</label>
                    <input type="range" class="track-delay" data-track="1" min="0" max="100" value="0">
                    <span class="effect-value">0</span>
                </div>
                <div class="effect-control">
                    <label>Volume</label>
                    <input type="range" class="track-volume" data-track="1" min="0" max="100" value="70">
                    <span class="effect-value">70</span>
                </div>
                <div class="effect-control">
                    <label>Decay</label>
                    <input type="range" class="track-decay" data-track="1" min="0" max="100" value="0">
                    <span class="effect-value">10</span>
                </div>
            </div>
        </div>
        <div class="track-control-row" data-track="2">
            <div class="track-control-header">
                <span class="track-label">Track 3</span>
                <div class="track-controls-actions">
                    <button class="sound-gen-btn" data-track="2" title="Generate sound from text">GEN</button>
                    <button class="effects-toggle-btn" data-track="2" title="Toggle effects panel">FX</button>
                </div>
            </div>
            <select class="sound-selector" data-track="2" title="Select sound for this track">
                <option value="">No sound loaded</option>
            </select>
            <div class="track-effects-panel" data-track="2">
                <div class="effect-control">
                    <label>Reverb</label>
                    <input type="range" class="track-reverb" data-track="2" min="0" max="100" value="0">
                    <span class="effect-value">30</span>
                </div>
                <div class="effect-control">
                    <label>Delay</label>
                    <input type="range" class="track-delay" data-track="2" min="0" max="100" value="0">
                    <span class="effect-value">0</span>
                </div>
                <div class="effect-control">
                    <label>Volume</label>
                    <input type="range" class="track-volume" data-track="2" min="0" max="100" value="70">
                    <span class="effect-value">70</span>
                </div>
                <div class="effect-control">
                    <label>Decay</label>
                    <input type="range" class="track-decay" data-track="2" min="0" max="100" value="0">
                    <span class="effect-value">10</span>
                </div>
            </div>
        </div>
        <div class="track-control-row" data-track="3">
            <div class="track-control-header">
                <span class="track-label">Track 4</span>
                <div class="track-controls-actions">
                    <button class="sound-gen-btn" data-track="3" title="Generate sound from text">GEN</button>
                    <button class="effects-toggle-btn" data-track="3" title="Toggle effects panel">FX</button>
                </div>
            </div>
            <select class="sound-selector" data-track="3" title="Select sound for this track">
                <option value="">No sound loaded</option>
            </select>
            <div class="track-effects-panel" data-track="3">
                <div class="effect-control">
                    <label>Reverb</label>
                    <input type="range" class="track-reverb" data-track="3" min="0" max="100" value="0">
                    <span class="effect-value">30</span>
                </div>
                <div class="effect-control">
                    <label>Delay</label>
                    <input type="range" class="track-delay" data-track="3" min="0" max="100" value="0">
                    <span class="effect-value">0</span>
                </div>
                <div class="effect-control">
                    <label>Volume</label>
                    <input type="range" class="track-volume" data-track="3" min="0" max="100" value="70">
                    <span class="effect-value">70</span>
                </div>
                <div class="effect-control">
                    <label>Decay</label>
                    <input type="range" class="track-decay" data-track="3" min="0" max="100" value="0">
                    <span class="effect-value">10</span>
                </div>
            </div>
        </div>
        <div class="track-control-row" data-track="4">
            <div class="track-control-header">
                <span class="track-label">Track 5</span>
                <div class="track-controls-actions">
                    <button class="sound-gen-btn" data-track="4" title="Generate sound from text">GEN</button>
                    <button class="effects-toggle-btn" data-track="4" title="Toggle effects panel">FX</button>
                </div>
            </div>
            <select class="sound-selector" data-track="4" title="Select sound for this track">
                <option value="">No sound loaded</option>
            </select>
            <div class="track-effects-panel" data-track="4">
                <div class="effect-control">
                    <label>Reverb</label>
                    <input type="range" class="track-reverb" data-track="4" min="0" max="100" value="0">
                    <span class="effect-value">30</span>
                </div>
                <div class="effect-control">
                    <label>Delay</label>
                    <input type="range" class="track-delay" data-track="4" min="0" max="100" value="0">
                    <span class="effect-value">0</span>
                </div>
                <div class="effect-control">
                    <label>Volume</label>
                    <input type="range" class="track-volume" data-track="4" min="0" max="100" value="70">
                    <span class="effect-value">70</span>
                </div>
                <div class="effect-control">
                    <label>Decay</label>
                    <input type="range" class="track-decay" data-track="4" min="0" max="100" value="0">
                    <span class="effect-value">10</span>
                </div>
            </div>
        </div>
        <div class="track-control-row" data-track="5">
            <div class="track-control-header">
                <span class="track-label">Track 6</span>
                <div class="track-controls-actions">
                    <button class="sound-gen-btn" data-track="5" title="Generate sound from text">GEN</button>
                    <button class="effects-toggle-btn" data-track="5" title="Toggle effects panel">FX</button>
                </div>
            </div>
            <select class="sound-selector" data-track="5" title="Select sound for this track">
                <option value="">No sound loaded</option>
            </select>
            <div class="track-effects-panel" data-track="5">
                <div class="effect-control">
                    <label>Reverb</label>
                    <input type="range" class="track-reverb" data-track="5" min="0" max="100" value="0">
                    <span class="effect-value">30</span>
                </div>
                <div class="effect-control">
                    <label>Delay</label>
                    <input type="range" class="track-delay" data-track="5" min="0" max="100" value="0">
                    <span class="effect-value">0</span>
                </div>
                <div class="effect-control">
                    <label>Volume</label>
                    <input type="range" class="track-volume" data-track="5" min="0" max="100" value="70">
                    <span class="effect-value">70</span>
                </div>
                <div class="effect-control">
                    <label>Decay</label>
                    <input type="range" class="track-decay" data-track="5" min="0" max="100" value="0">
                    <span class="effect-value">10</span>
                </div>
            </div>
        </div>
        <div class="track-control-row" data-track="6">
            <div class="track-control-header">
                <span class="track-label">Track 7</span>
                <div class="track-controls-actions">
                    <button class="sound-gen-btn" data-track="6" title="Generate sound from text">GEN</button>
                    <button class="effects-toggle-btn" data-track="6" title="Toggle effects panel">FX</button>
                </div>
            </div>
            <select class="sound-selector" data-track="6" title="Select sound for this track">
                <option value="">No sound loaded</option>
            </select>
            <div class="track-effects-panel" data-track="6">
                <div class="effect-control">
                    <label>Reverb</label>
                    <input type="range" class="track-reverb" data-track="6" min="0" max="100" value="0">
                    <span class="effect-value">30</span>
                </div>
                <div class="effect-control">
                    <label>Delay</label>
                    <input type="range" class="track-delay" data-track="6" min="0" max="100" value="0">
                    <span class="effect-value">0</span>
                </div>
                <div class="effect-control">
                    <label>Volume</label>
                    <input type="range" class="track-volume" data-track="6" min="0" max="100" value="70">
                    <span class="effect-value">70</span>
                </div>
                <div class="effect-control">
                    <label>Decay</label>
                    <input type="range" class="track-decay" data-track="6" min="0" max="100" value="0">
                    <span class="effect-value">10</span>
                </div>
            </div>
        </div>
        <div class="track-control-row" data-track="7">
            <div class="track-control-header">
                <span class="track-label">Track 8</span>
                <div class="track-controls-actions">
                    <button class="sound-gen-btn" data-track="7" title="Generate sound from text">GEN</button>
                    <button class="effects-toggle-btn" data-track="7" title="Toggle effects panel">FX</button>
                </div>
            </div>
            <select class="sound-selector" data-track="7" title="Select sound for this track">
                <option value="">No sound loaded</option>
            </select>
            <div class="track-effects-panel" data-track="7">
                <div class="effect-control">
                    <label>Reverb</label>
                    <input type="range" class="track-reverb" data-track="7" min="0" max="100" value="0">
                    <span class="effect-value">30</span>
                </div>
                <div class="effect-control">
                    <label>Delay</label>
                    <input type="range" class="track-delay" data-track="7" min="0" max="100" value="0">
                    <span class="effect-value">0</span>
                </div>
                <div class="effect-control">
                    <label>Volume</label>
                    <input type="range" class="track-volume" data-track="7" min="0" max="100" value="70">
                    <span class="effect-value">70</span>
                </div>
                <div class="effect-control">
                    <label>Decay</label>
                    <input type="range" class="track-decay" data-track="7" min="0" max="100" value="0">
                    <span class="effect-value">10</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Top Menu Bar -->
    <div class="top-menu">
        <button class="menu-item" id="new-project-btn">New</button>
        <button class="menu-item" id="save-project-btn">Save</button>
        <button class="menu-item" id="save-as-btn">Save As</button>
        <button class="menu-item" id="projects-btn">Projects</button>
        <button class="menu-item" id="import-btn">Import</button>
        <button class="menu-item" id="export-btn">Export</button>
        <input type="file" id="import-project-input" accept=".json" style="display: none;">
        <button class="menu-item" id="sounds-btn">Sounds</button>
        <button class="menu-item" id="panic">Stop All</button>
    </div>
    
    <!-- Canvas for particle effects -->
    <canvas id="particleCanvas"></canvas>
    
    <!-- Multi-track View -->
    <div class="multi-track-view">
        <!-- Instrument zones overlay -->
        <div class="instrument-zones">
            <div class="instrument-zone" data-track="0"></div>
            <div class="instrument-zone" data-track="1"></div>
            <div class="instrument-zone" data-track="2"></div>
            <div class="instrument-zone" data-track="3"></div>
            <div class="instrument-zone" data-track="4"></div>
            <div class="instrument-zone" data-track="5"></div>
            <div class="instrument-zone" data-track="6"></div>
            <div class="instrument-zone" data-track="7"></div>
        </div>
    </div>
    
    <div class="control-panel">
        <div class="panel-header">
            <h3>8-Track Studio Controls</h3>
            <button id="collapse-btn">−</button>
        </div>
        
        <div class="panel-content">
            <div class="controls-row">
                <div class="control-item">
                    <label>Scale</label>
                    <select id="scale">
                        <option value="chromatic">Chromatic</option>
                        <option value="major">Major</option>
                        <option value="minor">Minor</option>
                        <option value="pentatonic">Pentatonic</option>
                        <option value="blues">Blues</option>
                        <option value="arabic">Arabic</option>
                        <option value="japanese">Japanese</option>
                        <option value="wholetone">Whole Tone</option>
                    </select>
                </div>
                
                <div class="control-item">
                    <label>Key</label>
                    <select id="key">
                        <option value="C">C</option>
                        <option value="C#">C#</option>
                        <option value="D">D</option>
                        <option value="D#">D#</option>
                        <option value="E">E</option>
                        <option value="F">F</option>
                        <option value="F#">F#</option>
                        <option value="G">G</option>
                        <option value="G#">G#</option>
                        <option value="A">A</option>
                        <option value="A#">A#</option>
                        <option value="B">B</option>
                    </select>
                </div>
                
                <div class="control-item">
                    <label>Base Octave</label>
                    <input type="range" id="octave" min="1" max="6" value="3">
                    <span id="octaveValue">3</span>
                </div>
                
                <div class="control-item">
                    <label>BPM</label>
                    <input type="range" id="bpm" min="60" max="200" value="120">
                    <span id="bpmValue">120</span>
                </div>
                
                <div class="control-item">
                    <label>Metronome</label>
                    <button id="metronome-toggle" class="metro-btn">Off</button>
                </div>
            </div>
            
            <div class="action-buttons">
                <button id="play">▶ Play</button>
                <button id="stop">◼ Stop</button>
                <button id="clear">Clear</button>
                <button id="panic2">Stop All</button>
            </div>
        </div>
    </div>
    
    <div class="touch-indicators">
        <!-- Touch indicators will be dynamically added here -->
    </div>
    
    <div class="debug-panel">
        <div class="debug-header">
            <span>Debug Log</span>
            <div class="debug-buttons">
                <button id="toggle-debug">Hide</button>
                <button id="copy-debug">Copy</button>
                <button id="clear-debug">Clear</button>
            </div>
        </div>
        <div id="debug-log"></div>
    </div>
    
    <!-- Sound Generation Modal -->
    <div class="sound-gen-modal" style="display: none;">
        <div class="modal-content">
            <h3>Generate Sound for <span id="track-number"></span></h3>
            <div class="api-key-section">
                <label>ElevenLabs API Key:</label>
                <input type="password" id="elevenlabs-api-key" placeholder="Enter your API key">
                <button id="save-api-key">Save</button>
            </div>
            <div class="sound-gen-section">
                <label>Describe the sound you want:</label>
                <textarea id="sound-prompt" placeholder="e.g., 'deep bass drum hit', 'ethereal choir ahh', 'laser synth zap'"></textarea>
                
                <!-- Prompt Builder Section -->
                <div class="prompt-builder-section">
                    <h4>Sound Builder - Select a sound type + adjectives:</h4>
                    
                    <!-- Sound Type Selection -->
                    <div class="sound-type-section">
                        <h5>1. Choose Sound Type <span class="selection-count">(Select 1)</span></h5>
                        <div class="sound-type-grid">
                            <!-- Drums & Percussion -->
                            <button class="sound-type-btn" data-sound="kick drum">Kick Drum</button>
                            <button class="sound-type-btn" data-sound="snare drum">Snare Drum</button>
                            <button class="sound-type-btn" data-sound="hi-hat">Hi-Hat</button>
                            <button class="sound-type-btn" data-sound="cymbal">Cymbal</button>
                            <button class="sound-type-btn" data-sound="tom drum">Tom Drum</button>
                            <button class="sound-type-btn" data-sound="clap">Clap</button>
                            <button class="sound-type-btn" data-sound="shaker">Shaker</button>
                            <button class="sound-type-btn" data-sound="cowbell">Cowbell</button>
                            
                            <!-- Bass & Low End -->
                            <button class="sound-type-btn" data-sound="bass">Bass</button>
                            <button class="sound-type-btn" data-sound="sub bass">Sub Bass</button>
                            <button class="sound-type-btn" data-sound="bass drop">Bass Drop</button>
                            <button class="sound-type-btn" data-sound="808">808</button>
                            
                            <!-- Synths & Leads -->
                            <button class="sound-type-btn" data-sound="synth lead">Synth Lead</button>
                            <button class="sound-type-btn" data-sound="arpeggio">Arpeggio</button>
                            <button class="sound-type-btn" data-sound="pluck">Pluck</button>
                            <button class="sound-type-btn" data-sound="stab">Stab</button>
                            <button class="sound-type-btn" data-sound="sequence">Sequence</button>
                            
                            <!-- Pads & Atmosphere -->
                            <button class="sound-type-btn" data-sound="pad">Pad</button>
                            <button class="sound-type-btn" data-sound="drone">Drone</button>
                            <button class="sound-type-btn" data-sound="choir">Choir</button>
                            <button class="sound-type-btn" data-sound="strings">Strings</button>
                            <button class="sound-type-btn" data-sound="bells">Bells</button>
                            <button class="sound-type-btn" data-sound="ambient texture">Ambient</button>
                            
                            <!-- Effects & Transitions -->
                            <button class="sound-type-btn" data-sound="sweep">Sweep</button>
                            <button class="sound-type-btn" data-sound="zap">Zap</button>
                            <button class="sound-type-btn" data-sound="whoosh">Whoosh</button>
                            <button class="sound-type-btn" data-sound="impact">Impact</button>
                            <button class="sound-type-btn" data-sound="riser">Riser</button>
                            
                            <!-- Vocal & Human -->
                            <button class="sound-type-btn" data-sound="vocal">Vocal</button>
                            <button class="sound-type-btn" data-sound="voice">Voice</button>
                            <button class="sound-type-btn" data-sound="chant">Chant</button>
                            <button class="sound-type-btn" data-sound="breath">Breath</button>
                            
                            <!-- World & Ethnic -->
                            <button class="sound-type-btn" data-sound="djembe">Djembe</button>
                            <button class="sound-type-btn" data-sound="tabla">Tabla</button>
                            <button class="sound-type-btn" data-sound="sitar">Sitar</button>
                            <button class="sound-type-btn" data-sound="didgeridoo">Didgeridoo</button>
                            <button class="sound-type-btn" data-sound="flute">Flute</button>
                            
                            <!-- Organic & Foley -->
                            <button class="sound-type-btn" data-sound="rain">Rain</button>
                            <button class="sound-type-btn" data-sound="wind">Wind</button>
                            <button class="sound-type-btn" data-sound="fire">Fire</button>
                            <button class="sound-type-btn" data-sound="water">Water</button>
                            <button class="sound-type-btn" data-sound="footsteps">Footsteps</button>
                        </div>
                    </div>
                    
                    <!-- Adjectives Selection -->
                    <div class="adjectives-section">
                        <h5>2. Add Adjectives <span class="selection-count">(Select multiple)</span></h5>
                        <div class="adjectives-grid">
                            <!-- Tone & Character -->
                            <div class="adjective-category">
                                <h6>Tone & Character</h6>
                                <div class="adjective-buttons">
                                    <button class="adjective-btn" data-adjective="deep">Deep</button>
                                    <button class="adjective-btn" data-adjective="bright">Bright</button>
                                    <button class="adjective-btn" data-adjective="dark">Dark</button>
                                    <button class="adjective-btn" data-adjective="warm">Warm</button>
                                    <button class="adjective-btn" data-adjective="cold">Cold</button>
                                    <button class="adjective-btn" data-adjective="rich">Rich</button>
                                    <button class="adjective-btn" data-adjective="thin">Thin</button>
                                    <button class="adjective-btn" data-adjective="thick">Thick</button>
                                    <button class="adjective-btn" data-adjective="hollow">Hollow</button>
                                    <button class="adjective-btn" data-adjective="full">Full</button>
                                </div>
                            </div>
                            
                            <!-- Texture & Quality -->
                            <div class="adjective-category">
                                <h6>Texture & Quality</h6>
                                <div class="adjective-buttons">
                                    <button class="adjective-btn" data-adjective="smooth">Smooth</button>
                                    <button class="adjective-btn" data-adjective="rough">Rough</button>
                                    <button class="adjective-btn" data-adjective="crisp">Crisp</button>
                                    <button class="adjective-btn" data-adjective="soft">Soft</button>
                                    <button class="adjective-btn" data-adjective="hard">Hard</button>
                                    <button class="adjective-btn" data-adjective="fuzzy">Fuzzy</button>
                                    <button class="adjective-btn" data-adjective="clean">Clean</button>
                                    <button class="adjective-btn" data-adjective="dirty">Dirty</button>
                                    <button class="adjective-btn" data-adjective="gritty">Gritty</button>
                                    <button class="adjective-btn" data-adjective="glassy">Glassy</button>
                                </div>
                            </div>
                            
                            <!-- Dynamics & Energy -->
                            <div class="adjective-category">
                                <h6>Dynamics & Energy</h6>
                                <div class="adjective-buttons">
                                    <button class="adjective-btn" data-adjective="punchy">Punchy</button>
                                    <button class="adjective-btn" data-adjective="aggressive">Aggressive</button>
                                    <button class="adjective-btn" data-adjective="gentle">Gentle</button>
                                    <button class="adjective-btn" data-adjective="powerful">Powerful</button>
                                    <button class="adjective-btn" data-adjective="subtle">Subtle</button>
                                    <button class="adjective-btn" data-adjective="explosive">Explosive</button>
                                    <button class="adjective-btn" data-adjective="mellow">Mellow</button>
                                    <button class="adjective-btn" data-adjective="intense">Intense</button>
                                    <button class="adjective-btn" data-adjective="relaxed">Relaxed</button>
                                    <button class="adjective-btn" data-adjective="energetic">Energetic</button>
                                </div>
                            </div>
                            
                            <!-- Space & Dimension -->
                            <div class="adjective-category">
                                <h6>Space & Dimension</h6>
                                <div class="adjective-buttons">
                                    <button class="adjective-btn" data-adjective="spacious">Spacious</button>
                                    <button class="adjective-btn" data-adjective="intimate">Intimate</button>
                                    <button class="adjective-btn" data-adjective="wide">Wide</button>
                                    <button class="adjective-btn" data-adjective="narrow">Narrow</button>
                                    <button class="adjective-btn" data-adjective="reverberant">Reverberant</button>
                                    <button class="adjective-btn" data-adjective="dry">Dry</button>
                                    <button class="adjective-btn" data-adjective="ambient">Ambient</button>
                                    <button class="adjective-btn" data-adjective="close">Close</button>
                                    <button class="adjective-btn" data-adjective="distant">Distant</button>
                                    <button class="adjective-btn" data-adjective="echoing">Echoing</button>
                                </div>
                            </div>
                            
                            <!-- Style & Genre -->
                            <div class="adjective-category">
                                <h6>Style & Genre</h6>
                                <div class="adjective-buttons">
                                    <button class="adjective-btn" data-adjective="vintage">Vintage</button>
                                    <button class="adjective-btn" data-adjective="modern">Modern</button>
                                    <button class="adjective-btn" data-adjective="retro">Retro</button>
                                    <button class="adjective-btn" data-adjective="futuristic">Futuristic</button>
                                    <button class="adjective-btn" data-adjective="analog">Analog</button>
                                    <button class="adjective-btn" data-adjective="digital">Digital</button>
                                    <button class="adjective-btn" data-adjective="8-bit">8-bit</button>
                                    <button class="adjective-btn" data-adjective="lo-fi">Lo-fi</button>
                                    <button class="adjective-btn" data-adjective="hi-fi">Hi-fi</button>
                                    <button class="adjective-btn" data-adjective="cinematic">Cinematic</button>
                                </div>
                            </div>
                            
                            <!-- Processing & Effects -->
                            <div class="adjective-category">
                                <h6>Processing & Effects</h6>
                                <div class="adjective-buttons">
                                    <button class="adjective-btn" data-adjective="distorted">Distorted</button>
                                    <button class="adjective-btn" data-adjective="filtered">Filtered</button>
                                    <button class="adjective-btn" data-adjective="compressed">Compressed</button>
                                    <button class="adjective-btn" data-adjective="saturated">Saturated</button>
                                    <button class="adjective-btn" data-adjective="overdriven">Overdriven</button>
                                    <button class="adjective-btn" data-adjective="phased">Phased</button>
                                    <button class="adjective-btn" data-adjective="flanged">Flanged</button>
                                    <button class="adjective-btn" data-adjective="delayed">Delayed</button>
                                    <button class="adjective-btn" data-adjective="pitched">Pitched</button>
                                    <button class="adjective-btn" data-adjective="modulated">Modulated</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Musical Options -->
                    <div class="musical-options-section">
                        <h5>3. Musical Options <span class="selection-count">(Optional)</span></h5>
                        <div class="musical-options-grid">
                            <label class="checkbox-option">
                                <input type="checkbox" id="include-project-key" class="musical-checkbox">
                                <span class="checkmark"></span>
                                <span class="option-text">In project key (<span id="current-key-display">C</span>)</span>
                            </label>
                            <label class="checkbox-option">
                                <input type="checkbox" id="include-tempo" class="musical-checkbox">
                                <span class="checkmark"></span>
                                <span class="option-text">At project tempo (<span id="current-bpm-display">120</span> BPM)</span>
                            </label>
                            <label class="checkbox-option">
                                <input type="checkbox" id="include-scale" class="musical-checkbox">
                                <span class="checkmark"></span>
                                <span class="option-text">In project scale (<span id="current-scale-display">major</span>)</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Builder Actions -->
                    <div class="builder-actions">
                        <div class="action-buttons-row">
                            <button id="build-prompt-btn" class="build-prompt-btn">🔨 Build Prompt</button>
                            <button id="clear-prompt-btn" class="clear-prompt-btn">📝 Clear Prompt</button>
                            <button id="clear-selection-btn" class="clear-selection-btn">🗑️ Clear All</button>
                        </div>
                        <div class="selection-preview">
                            <strong>Preview:</strong> <span id="prompt-preview">Select a sound type and adjectives</span>
                        </div>
                    </div>
                </div>
                
                <div class="gen-actions">
                    <button id="generate-sound">Generate 3 Variations</button>
                    <button id="cancel-gen">Cancel</button>
                </div>
                <div class="loading-indicator" style="display: none;">
                    <div class="spinner"></div>
                    <p>Generating 3 sound variations...</p>
                </div>
                
                <!-- Generated Sounds Results -->
                <div class="generated-sounds-section" style="display: none;">
                    <h4>🎵 Generated Sounds - Choose which ones to add:</h4>
                    <div class="generated-sounds-grid" id="generated-sounds-grid">
                        <!-- Generated sound items will be added here -->
                    </div>
                    <div class="results-actions">
                        <button id="add-all-sounds" class="add-all-btn">✨ Add All to Library</button>
                        <button id="generate-more" class="generate-more-btn">🔄 Generate 3 More</button>
                        <button id="close-results" class="close-results-btn">✅ Done</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Sound Library Modal -->
    <div id="sound-library-modal" class="modal" style="display: none;">
        <div class="modal-content sound-library-content">
            <div class="modal-header">
                <h2>Sound Library</h2>
                <button class="close-btn" id="close-sound-library">&times;</button>
            </div>
            <div class="sound-categories">
                <button class="category-btn active" data-category="all">All</button>
                <button class="category-btn" data-category="kick">Kick</button>
                <button class="category-btn" data-category="snare">Snare</button>
                <button class="category-btn" data-category="hihat">Hi-Hat</button>
                <button class="category-btn" data-category="percussion">Percussion</button>
                <button class="category-btn" data-category="bass">Bass</button>
                <button class="category-btn" data-category="lead">Lead</button>
                <button class="category-btn" data-category="arp">Arp</button>
                <button class="category-btn" data-category="pluck">Pluck</button>
                <button class="category-btn" data-category="stab">Stab</button>
                <button class="category-btn" data-category="pad">Pad</button>
                <button class="category-btn" data-category="drone">Drone</button>
                <button class="category-btn" data-category="strings">Strings</button>
                <button class="category-btn" data-category="bells">Bells</button>
                <button class="category-btn" data-category="vocal">Vocal</button>
                <button class="category-btn" data-category="fx">FX</button>
                <button class="category-btn" data-category="world">World</button>
                <button class="category-btn" data-category="organic">Organic</button>
                <button class="category-btn" data-category="favorites">Favorites</button>
            </div>
            <div class="sound-list" id="sound-list">
                <!-- Sound items will be populated here -->
            </div>
            <div class="library-controls">
                <button id="add-category-btn">+ Category</button>
                <button id="generate-new-sound-btn">Generate New</button>
            </div>
        </div>
    </div>
    
    <!-- Beat Sequencer Section -->
    <div class="beat-sequencer-section">
        <div class="sequencer-header">
            <div class="sequencer-title">
                <h3>Beat Sequencer</h3>
                <p class="sequencer-help">Left click: toggle step | Right click: change pitch</p>
            </div>
            <div class="sequencer-controls">
                <button id="seq-play-btn" class="seq-control-btn">▶</button>
                <button id="seq-stop-btn" class="seq-control-btn">◼</button>
                <button id="seq-clear-btn" class="seq-control-btn">Clear</button>
                <button id="seq-toggle-btn" class="seq-toggle-btn">Show Sequencer</button>
                <div class="seq-settings">
                    <label>Pattern Length:</label>
                    <select id="pattern-length">
                        <option value="16">16 Steps</option>
                        <option value="32">32 Steps</option>
                        <option value="8">8 Steps</option>
                    </select>
                    <label>Swing:</label>
                    <input type="range" id="swing-control" min="0" max="100" value="0">
                    <span id="swing-value">0%</span>
                </div>
            </div>
        </div>
        
        <div class="sequencer-grid" style="display: none;">
            <div class="sequencer-tracks">
                <!-- Track 1 -->
                <div class="seq-track" data-track="0">
                    <div class="seq-track-info">
                        <span class="seq-track-label">Track 1</span>
                        <button class="seq-track-mute" data-track="0">M</button>
                        <button class="seq-track-solo" data-track="0">S</button>
                        <input type="range" class="seq-track-volume" data-track="0" min="0" max="100" value="70">
                    </div>
                    <div class="seq-steps" data-track="0">
                        <!-- Steps will be generated dynamically -->
                    </div>
                </div>
                
                <!-- Track 2 -->
                <div class="seq-track" data-track="1">
                    <div class="seq-track-info">
                        <span class="seq-track-label">Track 2</span>
                        <button class="seq-track-mute" data-track="1">M</button>
                        <button class="seq-track-solo" data-track="1">S</button>
                        <input type="range" class="seq-track-volume" data-track="1" min="0" max="100" value="70">
                    </div>
                    <div class="seq-steps" data-track="1">
                    </div>
                </div>
                
                <!-- Track 3 -->
                <div class="seq-track" data-track="2">
                    <div class="seq-track-info">
                        <span class="seq-track-label">Track 3</span>
                        <button class="seq-track-mute" data-track="2">M</button>
                        <button class="seq-track-solo" data-track="2">S</button>
                        <input type="range" class="seq-track-volume" data-track="2" min="0" max="100" value="70">
                    </div>
                    <div class="seq-steps" data-track="2">
                    </div>
                </div>
                
                <!-- Track 4 -->
                <div class="seq-track" data-track="3">
                    <div class="seq-track-info">
                        <span class="seq-track-label">Track 4</span>
                        <button class="seq-track-mute" data-track="3">M</button>
                        <button class="seq-track-solo" data-track="3">S</button>
                        <input type="range" class="seq-track-volume" data-track="3" min="0" max="100" value="70">
                    </div>
                    <div class="seq-steps" data-track="3">
                    </div>
                </div>
                
                <!-- Track 5 -->
                <div class="seq-track" data-track="4">
                    <div class="seq-track-info">
                        <span class="seq-track-label">Track 5</span>
                        <button class="seq-track-mute" data-track="4">M</button>
                        <button class="seq-track-solo" data-track="4">S</button>
                        <input type="range" class="seq-track-volume" data-track="4" min="0" max="100" value="70">
                    </div>
                    <div class="seq-steps" data-track="4">
                    </div>
                </div>
                
                <!-- Track 6 -->
                <div class="seq-track" data-track="5">
                    <div class="seq-track-info">
                        <span class="seq-track-label">Track 6</span>
                        <button class="seq-track-mute" data-track="5">M</button>
                        <button class="seq-track-solo" data-track="5">S</button>
                        <input type="range" class="seq-track-volume" data-track="5" min="0" max="100" value="70">
                    </div>
                    <div class="seq-steps" data-track="5">
                    </div>
                </div>
                
                <!-- Track 7 -->
                <div class="seq-track" data-track="6">
                    <div class="seq-track-info">
                        <span class="seq-track-label">Track 7</span>
                        <button class="seq-track-mute" data-track="6">M</button>
                        <button class="seq-track-solo" data-track="6">S</button>
                        <input type="range" class="seq-track-volume" data-track="6" min="0" max="100" value="70">
                    </div>
                    <div class="seq-steps" data-track="6">
                    </div>
                </div>
                
                <!-- Track 8 -->
                <div class="seq-track" data-track="7">
                    <div class="seq-track-info">
                        <span class="seq-track-label">Track 8</span>
                        <button class="seq-track-mute" data-track="7">M</button>
                        <button class="seq-track-solo" data-track="7">S</button>
                        <input type="range" class="seq-track-volume" data-track="7" min="0" max="100" value="70">
                    </div>
                    <div class="seq-steps" data-track="7">
                    </div>
                </div>
            </div>
            
            <!-- Step Numbers -->
            <div class="step-numbers">
                <!-- Will be generated dynamically -->
            </div>
            
            <!-- Playhead -->
            <div class="playhead" id="sequencer-playhead"></div>
        </div>
    </div>

    <!-- Audio Editor Modal -->
    <div id="audio-editor-modal" class="modal" style="display: none;">
        <div class="modal-content audio-editor-content">
            <div class="modal-header">
                <h2>Audio Editor</h2>
                <button class="close-btn" id="close-audio-editor">&times;</button>
            </div>
            <div class="audio-editor-controls">
                <button id="play-original-btn">▶ Play Original</button>
                <button id="play-trimmed-btn">▶ Play Trimmed</button>
                <button id="save-trimmed-btn">💾 Save Trimmed</button>
            </div>
            <div class="waveform-container">
                <canvas id="waveform-canvas" width="800" height="200"></canvas>
                <div class="trim-markers">
                    <div id="start-marker" class="trim-marker start-marker" style="left: 0%;">
                        <div class="marker-handle"></div>
                        <div class="marker-label">Start</div>
                    </div>
                    <div id="end-marker" class="trim-marker end-marker" style="left: 90%;">
                        <div class="marker-handle"></div>
                        <div class="marker-label">End</div>
                    </div>
                </div>
            </div>
            <div class="trim-info">
                <span id="start-time">0:00</span> - <span id="end-time">0:00</span>
                (<span id="duration-info">0:00</span>)
            </div>
        </div>
    </div>
    
    <!-- Track Picker Modal -->
    <div id="track-picker-modal" class="modal" style="display: none;">
        <div class="modal-content track-picker-content">
            <div class="modal-header">
                <h2>Load to Track</h2>
                <button class="close-btn" id="close-track-picker">&times;</button>
            </div>
            <div class="track-picker-grid">
                <button class="track-picker-btn" data-track="0">Track 1</button>
                <button class="track-picker-btn" data-track="1">Track 2</button>
                <button class="track-picker-btn" data-track="2">Track 3</button>
                <button class="track-picker-btn" data-track="3">Track 4</button>
                <button class="track-picker-btn" data-track="4">Track 5</button>
                <button class="track-picker-btn" data-track="5">Track 6</button>
                <button class="track-picker-btn" data-track="6">Track 7</button>
                <button class="track-picker-btn" data-track="7">Track 8</button>
            </div>
        </div>
    </div>
    
    <!-- Project Manager Modal -->
    <div id="project-manager-modal" class="modal" style="display: none;">
        <div class="modal-content project-manager-content">
            <div class="modal-header">
                <h2>Project Manager</h2>
                <button class="close-btn" id="close-project-manager">&times;</button>
            </div>
            <div class="project-manager-controls">
                <button id="new-project-from-manager" class="project-action-btn new-btn">+ New Project</button>
                <button id="refresh-projects" class="project-action-btn refresh-btn">🔄 Refresh</button>
            </div>
            <div class="projects-container">
                <div class="projects-header">
                    <span class="col-name">Project Name</span>
                    <span class="col-date">Last Modified</span>
                    <span class="col-actions">Actions</span>
                </div>
                <div class="projects-list" id="projects-list">
                    <!-- Project items will be populated here -->
                </div>
            </div>
            <div class="project-manager-footer">
                <div class="storage-info" id="storage-info">
                    <!-- Storage usage info will be shown here -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Custom Message Display -->
    <div id="custom-message" class="custom-message" style="display: none;">
        <div class="message-content">
            <span id="message-text"></span>
            <button id="message-close">&times;</button>
        </div>
    </div>
    
    <script src="debug.js"></script>
    <script src="tone-audio-engine.js"></script>
    <script src="script.js"></script>
</body>
</html>